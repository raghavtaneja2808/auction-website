<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortunez - Bid Now</title>
    <link rel="stylesheet" href="../styleSheets/bidding.css">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap"
      rel="stylesheet"
    />
    <link rel="icon" href="../favicon.png" type="image/x-icon" />
</head>
<body>
    <header>
        <div class="masterContainer">
          <!-- Logo -->
          <div class="headerItems">
            <a href="../index.html">
              <img src="../Graphic designing/logo_small.png" id="logo">
            </a>
          </div>
          <!-- Dialougue -->
          <div class="headerItems">
            <p id="motto">OVER 70 YEARS OF TRUST</p>
          </div>
          <!-- Login -->
          <div class="headerItems">
            <button id="logging">
              <a href="../login.html">
                SIGN IN
              </a>
            </button>
          </div>
        </div>
      </header>
      <hr >
      <nav>
        <div class="masterContainer">
          <button class="quickLinks">
            <a href="../activeNow.html">
              ACTIVE NOW
            </a></button>
            <button class="quickLinks">
              <a href="../results.html">
                RESULTS
              </a>
            </button>
            <button class="quickLinks">
              <a href="../categories2.html">
                CATEGORIES
              </a>
            </button>
            <!-- <button class="quickLinks">
              <a href="./reviews.html">
                REVIEWS
              </a>
            </button> -->
            <button class="quickLinks">
              <a href="../aboutUs.html">
                ABOUT US
              </a>
            </button>
        </div>
      </nav>

      <!-- ====================================================== -->
       <main>
        <div class="masterContainer bidItem">
            <div class="grids" id="title">
                <h3>
                  Renaissance-Era Marble Chess Set
                </h3>
            </div>
            <div class="grids" id="image">
                <img src="../Graphic designing/ActiveNow/chess.jpg" alt="">
            </div>
            <div class="grids" id="details">
                <div class="detailsChildren" id="description">
                  A stunning example of fine craftsmanship from the 16th century. Carved from high-quality marble, each piece in this set reflects the intricate artistry and attention to detail typical of the Renaissance period. The chess pieces are beautifully designed, with knights, kings, and queens captured in lifelike forms. This set not only offers a unique, historical way to engage in the game of chess but also serves as a symbol of the periodâ€™s cultural and artistic legacy. A rare treasure for collectors and history aficionados alike.
                </div>
                <div class="detailsChildren">
                    <p><span>Condition:</span> Perfect</p>
                    <p><span>Time left:</span></p>
                    <div id="timer">
                       <h3 id="hours">00</h3>
                       <p>hours</p>
                       <h3 id="minutes">00</h3>
                       <p>minutes</p>
                       <h3 id="seconds">00</h3>
                       <p>seconds</p>
                    </div>
                </div>
                <div class="detailsChildren" id="bidArea">
                    <h4>Current Bid : $8,000</h4>
                    <div id="bidDetails">
                        <h4>$</h4>
                        <input type="number" name="" id="bidInput">
                        <button class="bid-button" id="submitBid">bid now</button>
                    </div>
                    
                </div>
            </div>

        </div>
       </main>
       <!-- ================== -->

       <section>
            <div class="masterContainer">
                <h2>
                    auction history
                </h2>
                <div>
                  <table class="auction-history">
                    <thead>
                      <tr>
                        <th>Bidder</th>
                        <th>Bid Amount</th>
                        <th>Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>Charles Kingston</td>
                        <td>$8,000</td>
                        <td>8:20 PM</td>
                      </tr>
                      <tr>
                        <td>Rebecca Harris</td>
                        <td>$7,500</td>
                        <td>8:00 PM</td>
                      </tr>
                      <tr>
                        <td>Edward Montgomery</td>
                        <td>$7,000</td>
                        <td>7:40 PM</td>
                      </tr>
                      <tr>
                        <td>Victoria Bennett</td>
                        <td>$6,500</td>
                        <td>7:15 PM</td>
                      </tr>
                      <tr>
                        <td>Johnathan Roberts</td>
                        <td>$6,000</td>
                        <td>7:00 PM</td>
                      </tr>
                    </tbody>
                  </table>
                  
                </div>
                
            </div>
       </section>

       <!-- ===============footer================  -->

       <footer>
        <div class="masterContainer">
          <div class="footerGrids">
            <h3>
              Newsletter
            </h3>
            <hr>
            <div class="newsletter">
              <input type="text" placeholder="enter your email">
              <button>
                <a href="">subscribe</a>
              </button>
            </div>
            
      
          </div>
          <div class="footerGrids">
            <h3>
              About
            </h3>
            <hr>
            <a href="../aboutUs.html">About Us</a>
            <a href="">Careers</a>
            <a href="">Legal</a>
            <a href="">Privacy Policy</a>
            <a href="">Downloads</a>
          </div>
          
          <div class="footerGrids">
            <h3>
              Support
            </h3>
            <hr>
            <a href="">Customer Support</a>
            <a href="">FAQ</a>
            <a href="">Visit Fortunez Forum</a>
            <a href="">Privacy Policy</a>
            <a href="">Downloads</a>
          </div>
          <p> &copy All rights reserved</p>
        </div>
        
      </footer>
      
      <script>
        let time = 10;

// Get DOM elements 
const hours = document.getElementById("hours");
const mins = document.getElementById("minutes");
const secs = document.getElementById("seconds");

let bidInput = document.querySelector("#bidInput");
let btn = document.querySelector("#submitBid");
let dollar = document.querySelector("h4#dollar");
let currentBid = document.querySelector("h4#currentBid");

const bidArea = document.getElementById("bidArea");

// Start the timer
const timer = setInterval(() => {
  if (time <= 0) {
    clearInterval(timer); // Stop the timer when time reaches 0
    // Remove the bid input and button
    bidInput.remove();
    btn.remove();
    dollar.remove();

    // Lock the bidding functionality
    bidArea.innerHTML += "<p id='bidLocked'>Bidding Locked</p>";
    currentBid.setAttribute("style", "text-decoration: line-through;");

    hours.innerText = "00";
    mins.innerText = "00";
    secs.innerText = "00";

    return;
  }

  const hr = Math.floor(time / 3600);
  const min = Math.floor((time % 3600) / 60);
  const sec = time % 60;

  hours.innerText = hr.toString().padStart(2, "0");
  mins.innerText = min.toString().padStart(2, "0");
  secs.innerText = sec.toString().padStart(2, "0");

  time--;
}, 1000);

// Get the initial current bid amount
let currentBidAmount = parseInt(currentBid.innerText.replace('Current Bid : $', '').replace(',', ''));
let auctionHistory = JSON.parse(localStorage.getItem('auctionHistory')) || [];  // Retrieve history from localStorage or initialize it

let historyTable = document.querySelector(".auction-history tbody");

// Display auction history from localStorage when the page loads
function loadAuctionHistory() {
  auctionHistory.forEach(bid => {
    let newRow = document.createElement("tr");
    newRow.innerHTML = `
      <td>${bid.bidder}</td>
      <td>$${bid.amount.toLocaleString()}</td>
      <td>${formatTimeAgo(new Date(bid.timestamp))}</td>
    `;
    historyTable.appendChild(newRow);
  });
}

loadAuctionHistory();  // Load history when the page loads

btn.addEventListener("click", function() {
  let userBid = parseInt(bidInput.value); 

  if (isNaN(userBid)) {
    alert("Please enter a valid bid.");
    return;
  }

  if (userBid > currentBidAmount) {
    alert(`Your bid of $${userBid.toLocaleString()} has been placed!`);

    currentBidAmount = userBid;  // Update the current bid amount

    currentBid.innerText = "Current Bid : $" + currentBidAmount.toLocaleString();

    let username = "You";
    let timestamp = new Date(); 

    // Update auctionHistory
    auctionHistory.push({
      bidder: username,
      amount: userBid,
      timestamp: timestamp 
    });

    // Save auction history to localStorage
    localStorage.setItem('auctionHistory', JSON.stringify(auctionHistory));

    // Update the history table
    let newRow = document.createElement("tr");
    newRow.innerHTML = `
      <td>${username}</td>
      <td>$${userBid.toLocaleString()}</td>
      <td>${formatTimeAgo(timestamp)}</td> <!-- Display time ago -->
    `;
    historyTable.insertBefore(newRow, historyTable.firstChild);
  } else {
    alert("Your bid must be higher than the current bid.");
  }

  bidInput.value = "";
});

function formatTimeAgo(timestamp) {
  const now = new Date();
  const diffInSeconds = Math.floor((now - timestamp) / 1000);
  if (diffInSeconds < 60) {
    return "Less than a minute ago";
  } else if (diffInSeconds < 3600) {
    const minutes = Math.floor(diffInSeconds / 60);
    return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
  } else if (diffInSeconds < 86400) { 
    const hours = Math.floor(diffInSeconds / 3600);
    return `${hours} hour${hours > 1 ? 's' : ''} ago`;
  } else {
    const days = Math.floor(diffInSeconds / 86400);
    return `${days} day${days > 1 ? 's' : ''} ago`;
  }
}

      </script>
      
</body>
</html>